<!-- if i break da code, return to this version -->

{% macro generate_modal(room_types) %}
<!-- Maze Generate -->
<div class="modal fade" id="customMazeModal" tabindex="-1" role="dialog" aria-labelledby="customMazeModalLabel" aria-hidden="true">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <form method="POST" action="/maze/custom">
        <div class="modal-header">
          <h5 class="modal-title" id="customMazeModalLabel">Custom Maze Options</h5>
          <button type="button" class="close" data-bs-dismiss="modal" aria-label="Close">
            <span aria-hidden="true">&times;</span>
          </button>
        </div>
        <div class="modal-body">
          <div class="d-flex justify-content-between">
            <div id="room-filters" class="me-4">
              <p><strong>Room Types</strong></p>
              {% for room in room_types %}
                <label><input type="checkbox" name="room_type" value="{{ room }}" checked> {{ room }}</label><br>
              {% endfor %}
            </div>
            <div id="template-options">
              <p><strong>Dungeon Types</strong></p>
              <label><input type="radio" name="template" value="default" checked> Default</label><br>
              <label><input type="radio" name="template" value="haunted"> Haunted Dungeon</label><br>
              <label><input type="radio" name="template" value="castle"> Castle Layout</label><br>
              <label><input type="radio" name="template" value="labyrinth"> Labyrinth Maze</label><br>
              <label><input type="radio" name="template" value="corridor"> Corridor</label><br>
              <label><input type="radio" name="template" value="trick-or-treat"> Trick-Or-Treat</label><br>
              <label><input type="radio" name="template" value="wizard tower"> Wizard Tower</label><br>
              <label><input type="radio" name="template" value="stronghold"> Stronghold</label><br>
              <label><input type="radio" name="template" value="tomb"> Tomb</label><br>
            </div>
          </div>

          <hr>

          <div class="d-flex flex-wrap gap-2">
            <input type="text" name="room-num" placeholder="Room #" required>
            <input type="text" name="max-room-size" placeholder="Max Room Size" required>
            <input type="text" name="width" placeholder="Width" required>
            <input type="text" name="height" placeholder="Height" required>
          </div>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
          <button type="submit" class="btn btn-primary">Generate!</button>
        </div>
      </form>
    </div>
  </div>
</div>
<!-- filter rooms based on dungeon -->
<script>
  const dungeonRoomMap = {
    "stronghold": ["Prison Room", "Treasure Room", "Secret Room", "Armory"],
    "wizard": ["Treasure Room", "Secret Room", "Library", "Alchemy Lab", "Puzzle Room", "Magic Chamber"],
    "trick": ["Treasure Room", "Trap Room"],
    "labyrinth": ["Treasure Room", "Trap Room", "Monster Lair", "Secret Room", "Puzzle Room"],
    "tomb": ["Treasure Room", "Trap Room", "Secret Room"],
    "castle": ["Prison Room", "Treasure Room", "Secret Room", "Armory", "Library"],
    "haunted": ["Trap Room", "Monster Lair", "Secret Room", "Alchemy Lab", "Puzzle Room", "Magic Chamber"],
    "corridor": ["Treasure Room", "Trap Room", "Monster Lair", "Secret Room", "Alchemy Lab", "Puzzle Room"]
  };

  const dungeonRadios = document.querySelectorAll('input[name="template"]');
  const roomCheckboxes = document.querySelectorAll('input[name="room_type"]');

  function setRoomTypesForDungeon(type) {
    const selected = dungeonRoomMap[type] || null;
    if (!selected) return;
    roomCheckboxes.forEach(cb => {
      cb.checked = selected.includes(cb.value);
    });
  }

  dungeonRadios.forEach(radio => {
    radio.addEventListener("change", () => {
      const value = radio.value;
      if (value === "wizard tower") setRoomTypesForDungeon("wizard");
      else if (value === "trick-or-treat") setRoomTypesForDungeon("trick");
      else setRoomTypesForDungeon(value);
    });
  });
</script>
{% endmacro %}